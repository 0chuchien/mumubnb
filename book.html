<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MUMU 丨 木木民宿</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="icon" href="favicon.png" />
    <link rel="stylesheet" href="./style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <!-- 中文語系 -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh.js"></script>
    <!-- JS 主程式 -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  </head>
  <body>
    <div class="intro">
      <img id="logo" src="./pics/logo小.svg" alt="木木民宿 Logo" />
    </div>

    <nav class="navbar scrolled white-default">
      <div class="logo2">
        <a href="./index.html"> <img src="./pics/logo小.svg" alt="logo" /></a>
      </div>
      <ul class="nav-links">
        <li><a href="./index.html">首頁</a></li>
        <li><a href="./room.html">空間介紹</a></li>
        <li><a href="./equipment.html">設施總覽</a></li>
        <li><a href="./index.html#traffic123">交通與週邊</a></li>
        <div class="line"></div>
        <li><a href="./notice.html">訂房須知</a></li>
        <li class="box"><a class="active" href="#">預訂/價格</a></li>
      </ul>
      <div class="hamburger" onclick="toggleMenu()">☰</div>
    </nav>
    <!-- 全螢幕覆蓋選單 -->
    <div id="fullMenu" class="full-menu">
      <button id="closeMenu" class="close-button">✕</button>
      <ul class="menu-list">
        <li><a href="./index.html">首頁</a></li>
        <li><a href="./room.html">空間介紹</a></li>
        <li><a href="./equipment.html">設施總覽</a></li>
        <li><a href="./index.html#traffic123">交通與週邊</a></li>
        <li><a href="./notice.html">訂房須知</a></li>
        <li><a href="./book.html">預訂/價格</a></li>
      </ul>
    </div>

    <div class="container">
      <section class="section">
        <h1>包棟費用與說明</h1>
        <table class="price-table">
          <thead>
            <tr>
              <th>專案</th>
              <th>平日<br /><small>（週日～週四）</small></th>
              <th>旺日<br /><small>（週五、週日）</small></th>
              <th>假日<br /><small>（週六、暑假、國定假日）</small></th>
              <th>定價<br /><small>（春節、跨年）</small></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>標準包棟 <small>（16人）</small></td>
              <td>26,800</td>
              <td>30,800</td>
              <td>33,800</td>
              <td>66,800</td>
            </tr>
          </tbody>
        </table>

        <div class="price-note">
          <h3>1.連續入住第 2 晚 9 折，第 3 晚起 85 折。</h3>

          <h3>2.跨年、春節須全額付款。</h3>
          <h3>
            3.另提供平日12人以下連住小包棟優惠，若有需求歡迎洽詢LINE官方客服。
          </h3>
          <br />
          <p>*無提供加床服務</p>
          <p>*續住不提供更換床包、毛巾等房務清潔。</p>
        </div>
      </section>

      <section>
        <h2>請使用 LINE 官方帳號預訂</h2>

        <a
          href="https://line.me/R/ti/p/yourLineID"
          class="button"
          target="_blank"
          >加入 LINE 預訂</a
        >
      </section>
      <!-- ==== 預訂狀況月曆（放在包棟費用與說明的最下方）==== -->
      <div id="booking-calendar-wrapper" class="book-wrapper">
        <h3>訂房狀況</h3>
        <div id="reservation-calendar" class="calendar"></div>
        <div class="calendar-legend">
          <span class="dot"></span> 表示已經被預訂
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <div class="footer-content">
        <img class="smalllogo" src="./pics/logo小.svg" alt="logo" />
        <div class="footer-logo">MUMU 木木民宿</div>
        <div class="footer-info">
          <p>宜蘭縣民宿2434號</p>
          <p>地址：宜蘭縣冬山鄉東八路110號</p>
          <p>聯絡信箱：mumu269030@gmail.com</p>
          <p>
            官方Line：<a href="https://lin.ee/94RJiiC" target="_blank"
              >@160ajblq</a
            >
          </p>
          <p>
            官方Instagram：<a
              href="https://www.instagram.com/mumubnb?igsh=cXh3cnc1YTZsMXVk&utm_source=qr"
              target="_blank"
              >@mumubnb</a
            >
          </p>
        </div>
        <div class="footer-copy">&copy; 2025 MUMU 木木民宿. 保留所有權利。</div>
      </div>
    </footer>
    <script>
      let lastScroll = 0;
      const navbar = document.querySelector(".navbar");

      window.addEventListener("scroll", () => {
        const currentScroll = window.scrollY;
        const isMobile = window.innerWidth < 768; // 判斷是否手機寬度

        if (isMobile) {
          // 手機模式：固定白底、不隱藏
          navbar.classList.add("scrolled");
          navbar.classList.remove("hide");
          return; // 直接結束，不跑下面
        }

        // 桌機模式
        if (currentScroll > 10) {
          navbar.classList.add("scrolled");
        }

        if (currentScroll > lastScroll && currentScroll > 10) {
          // 向下滑
          navbar.classList.add("hide");
        } else {
          // 向上滑
          navbar.classList.remove("hide");
        }

        lastScroll = currentScroll;
      });
      // 漢堡選單
      document.addEventListener("DOMContentLoaded", () => {
        const hamburger = document.querySelector(".hamburger");
        const fullMenu = document.getElementById("fullMenu");
        const closeBtn = document.getElementById("closeMenu");

        hamburger.addEventListener("click", () => {
          fullMenu.classList.add("active");
        });
        closeBtn.addEventListener("click", () => {
          fullMenu.classList.remove("active");
        });
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>

    <script>
      function ymd(d) {
        return (
          d.getFullYear() +
          "-" +
          String(d.getMonth() + 1).padStart(2, "0") +
          "-" +
          String(d.getDate()).padStart(2, "0")
        );
      }

      let reservedDates = [];

      function fetchReservedJson(fpInstance) {
        return fetch("./reserved.json?_t=" + Date.now())
          .then((r) => {
            if (!r.ok) throw new Error("讀取 reserved.json 失敗");
            return r.json();
          })
          .then((data) => {
            reservedDates = data;
            fpInstance.set("disable", reservedDates);
            fpInstance.redraw();
            fpInstance.buildDays(); // 🔑 強制刷新日期
          })
          .catch((err) => console.error("載入 reserved.json 失敗：", err));
      }

      const fp = flatpickr("#reservation-calendar", {
        inline: true,
        static: true,
        clickOpens: false,
        locale: flatpickr.l10ns["zh_tw"],
        minDate: "today",
        dateFormat: "Y-m-d",
        monthSelectorType: "static",
        disable: [],
        onReady: function (sel, str, instance) {
          fetchReservedJson(instance);
        },
        onMonthChange: function (sel, str, instance) {
          fetchReservedJson(instance);
        },
        onYearChange: function (sel, str, instance) {
          fetchReservedJson(instance);
        },
        onDayCreate: function (dObj, dStr, fpInstance, dayElem) {
          const ds = ymd(dayElem.dateObj);
          if (reservedDates.includes(ds)) {
            dayElem.classList.add("booked");
            const dot = document.createElement("span");
            dot.className = "fp-booked-dot";
            dayElem.appendChild(dot);
          }
        },
      });
    </script>
  </body>
</html>
